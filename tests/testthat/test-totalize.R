test_that("esoph matrix works", {
	test_mat <- totalize(esoph, "ncases", c("agegp", "alcgp", "tobgp")) |> tomatrix(c(1, 2))
	ans_mat <- structure(c(200, 1, 9, 46, 76, 55, 13, 29, 0, 1, 1, 12, 11, 4, 
75, 0, 4, 20, 22, 25, 4, 51, 0, 0, 12, 24, 13, 2, 45, 1, 4, 13, 
18, 6, 3, 78, 0, 2, 14, 25, 31, 6, 9, 0, 0, 1, 2, 5, 1, 34, 0, 
0, 6, 9, 17, 2, 19, 0, 0, 3, 9, 6, 1, 16, 0, 2, 4, 5, 3, 2, 58, 
1, 4, 13, 23, 12, 5, 10, 0, 1, 0, 3, 4, 2, 17, 0, 3, 4, 6, 3, 
1, 19, 0, 0, 6, 8, 4, 1, 12, 1, 0, 3, 6, 1, 1, 33, 0, 3, 8, 12, 
10, 0, 5, 0, 0, 0, 3, 2, NA, 15, 0, 1, 5, 4, 5, 0, 6, NA, 0, 
1, 3, 2, NA, 7, 0, 2, 2, 2, 1, NA, 31, 0, 0, 11, 16, 2, 2, 5, 
0, 0, 0, 4, 0, 1, 9, 0, 0, 5, 3, NA, 1, 7, 0, 0, 2, 4, 1, NA, 
10, 0, NA, 4, 5, 1, NA), dim = c(35L, 5L), dimnames = list(`agegp,alcgp` = c("all|all", 
"25-34|all", "35-44|all", "45-54|all", "55-64|all", "65-74|all", 
"75+|all", "all|0-39g/day", "25-34|0-39g/day", "35-44|0-39g/day", 
"45-54|0-39g/day", "55-64|0-39g/day", "65-74|0-39g/day", "75+|0-39g/day", 
"all|40-79", "25-34|40-79", "35-44|40-79", "45-54|40-79", "55-64|40-79", 
"65-74|40-79", "75+|40-79", "all|80-119", "25-34|80-119", "35-44|80-119", 
"45-54|80-119", "55-64|80-119", "65-74|80-119", "75+|80-119", 
"all|120+", "25-34|120+", "35-44|120+", "45-54|120+", "55-64|120+", 
"65-74|120+", "75+|120+"), tobgp = c("all", "0-9g/day", "10-19", 
"20-29", "30+")))
	
	expect_equal(test_mat, ans_mat)
})
